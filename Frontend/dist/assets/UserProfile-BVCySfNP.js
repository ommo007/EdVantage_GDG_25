import{c as m,u as j,r as o,j as e,U as y,S as v}from"./index-CGocrW-2.js";import{s as b}from"./supabaseClient-XQ6Slhkl.js";import{D as w}from"./DashboardHeader-B5PeDfLb.js";import{M as k}from"./mail-DK66TUDf.js";import{X as S}from"./x-CKoSI4A3.js";import"./index-DAE5hqnr.js";import"./users-D5Ca1YqY.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],C=m("Briefcase",_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],M=m("Camera",P);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],F=m("Save",E),A=()=>{const{currentUser:a,userRole:x}=j(),[l,d]=o.useState(!1),[h,u]=o.useState(!1),[c,r]=o.useState({text:"",type:""}),[s,g]=o.useState({displayName:"",email:"",bio:"",location:"",phoneNumber:""});o.useEffect(()=>{a&&f()},[a]);const f=async()=>{try{const{data:i,error:t}=await b.from("profiles").select("*").eq("id",a.id).single();if(t)throw t;g({displayName:i.display_name||"",email:a.email||"",bio:i.bio||"",location:i.location||"",phoneNumber:i.phone_number||""})}catch(i){console.error("Failed to fetch user profile:",i),r({text:"Failed to load profile. Please try again.",type:"error"})}},n=i=>{const{name:t,value:N}=i.target;g({...s,[t]:N})},p=async i=>{i.preventDefault(),u(!0),r({text:"",type:""});try{const{error:t}=await b.from("profiles").update({display_name:s.displayName,bio:s.bio,location:s.location,phone_number:s.phoneNumber}).eq("id",a.id);if(t)throw t;r({text:"Profile updated successfully!",type:"success"}),d(!1)}catch(t){console.error("Error updating profile:",t),r({text:"Failed to update profile. Please try again.",type:"error"})}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-white",children:[e.jsx(w,{userRole:x}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-indigo-900 mb-8",children:"Your Profile"}),c.text&&e.jsx("div",{className:`mb-6 p-4 rounded-md ${c.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:c.text}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-indigo-100 overflow-hidden",children:[e.jsxs("div",{className:"bg-indigo-600 h-32 relative",children:[a!=null&&a.photo_url?e.jsx("div",{className:"absolute -bottom-16 left-8",children:e.jsx("div",{className:"h-32 w-32 rounded-full border-4 border-white overflow-hidden bg-white",children:e.jsx("img",{src:a.photo_url,alt:s.displayName||"User",className:"h-full w-full object-cover"})})}):e.jsx("div",{className:"absolute -bottom-16 left-8",children:e.jsx("div",{className:"h-32 w-32 rounded-full border-4 border-white bg-indigo-100 flex items-center justify-center",children:e.jsx(y,{className:"h-16 w-16 text-indigo-400"})})}),l&&e.jsx("button",{className:"absolute -bottom-8 left-24 bg-indigo-500 text-white p-2 rounded-full hover:bg-indigo-700 transition-colors",children:e.jsx(M,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"pt-20 px-8 pb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-indigo-900",children:s.displayName||"User Profile"}),e.jsxs("div",{className:"flex items-center mt-2 text-indigo-600",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:s.email})]}),e.jsxs("div",{className:"flex items-center mt-1 text-indigo-600",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"capitalize",children:x})]})]}),l?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>d(!1),className:"p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-100",children:e.jsx(S,{className:"h-5 w-5"})}),e.jsx("button",{onClick:p,disabled:h,className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:h?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})]}):e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center px-4 py-2 bg-indigo-100 text-indigo-600 rounded-md hover:bg-indigo-200",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})]}),l?e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-indigo-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",name:"displayName",value:s.displayName,onChange:n,className:"w-full px-4 py-2 border border-indigo-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-indigo-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:s.email,disabled:!0,className:"w-full px-4 py-2 border border-indigo-200 rounded-md bg-indigo-50 text-indigo-500"}),e.jsx("p",{className:"mt-1 text-xs text-indigo-400",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-indigo-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phoneNumber",value:s.phoneNumber,onChange:n,className:"w-full px-4 py-2 border border-indigo-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-indigo-700 mb-1",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:s.location,onChange:n,className:"w-full px-4 py-2 border border-indigo-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-indigo-700 mb-1",children:"Bio"}),e.jsx("textarea",{name:"bio",value:s.bio,onChange:n,rows:"4",className:"w-full px-4 py-2 border border-indigo-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}):e.jsxs("div",{className:"mt-6 space-y-6",children:[s.bio&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-indigo-900 mb-2",children:"About"}),e.jsx("p",{className:"text-indigo-600",children:s.bio})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.location&&e.jsxs("div",{className:"p-4 bg-indigo-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-indigo-700 mb-1",children:"Location"}),e.jsx("p",{className:"text-indigo-900",children:s.location})]}),s.phoneNumber&&e.jsxs("div",{className:"p-4 bg-indigo-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-indigo-700 mb-1",children:"Phone"}),e.jsx("p",{className:"text-indigo-900",children:s.phoneNumber})]})]})]})]})]})]})})]})};export{A as default};
